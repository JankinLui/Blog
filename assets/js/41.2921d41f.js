(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{556:function(s,a,n){"use strict";n.r(a);var e=n(2),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"第一章-配置单个dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一章-配置单个dns"}},[s._v("#")]),s._v(" 第一章 配置单个DNS")]),s._v(" "),a("h3",{attrs:{id:"_1-1-安装dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-安装dns"}},[s._v("#")]),s._v(" 1.1 安装DNS")]),s._v(" "),a("p",[s._v("获取DNS所有的软件包")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" bind*\n或\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" bind-chroot bind-utils\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_1-2-配置dns文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-配置dns文件"}},[s._v("#")]),s._v(" 1.2 配置DNS文件")]),s._v(" "),a("h4",{attrs:{id:"_1-2-1-修改dns主配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-修改dns主配置文件"}},[s._v("#")]),s._v(" 1.2.1 修改DNS主配置文件")]),s._v(" "),a("div",{staticClass:"language-vim line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vi")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("named"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("conf")]),s._v(" \n\t修改：\n\t\tlisten"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\tallow"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("query     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"_1-2-2-修改、反向解析配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-修改、反向解析配置文件"}},[s._v("#")]),s._v(" 1.2.2 修改、反向解析配置文件")]),s._v(" "),a("div",{staticClass:"language-vim line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vi")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("named"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("rfc1912"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("zones\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#添加：\nzone "ljq.com" IN {    #域名根据自己的需求变化\n\t\ttype master;\n\t\tfile "ljq.com.zone";\n\t\tallow-update { none; };\n};\nzone "221.168.192.in-addr.arpa" IN {     #ip根据自己的需求变化\n\t\ttype master;\n\t\tfile "221.168.192.rev";\n\t\tallow-update { none; };\n};\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/name\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" named.localhost ljq.com.zone\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" named.loopback "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("221.168")]),s._v(".192.rev\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" ljq.com.zone\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#修改：\n\t\t$TTL 1D\n\t\t@       IN SOA  @ root.ljq.com. (\n\t\t                                        0       ; serial\n\t\t                                        1D      ; refresh\n\t\t                                        1H      ; retry\n\t\t                                        1W      ; expire\n\t\t                                        3H )    ; minimum\n\t\t              NS      dns.ljq.com.\n\t\twww     A       192.168.221.7\n\t\tftp         A       192.168.221.7\n\t\tdns        A       192.168.221.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim 221.168.192.rev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#修改：\n\t\t$TTL 1D\n\t\t@       IN SOA  @ root.ljq.com. (\n\t\t                                        0       ; serial\n\t\t                                        1D      ; refresh\n\t\t                                        1H      ; retry\n\t\t                                        1W      ; expire\n\t\t                                        3H )    ; minimum\n\t\t        NS      dns.ljq.com.\n\t\t7       PTR     www.ljq.com\n\t\t7       PTR     ftp.ljq.com\n\t\t7       PTR     dns.ljq.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"_1-3-启动服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-启动服务"}},[s._v("#")]),s._v(" 1.3 启动服务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl start named.service            //启动dns服务\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" named.service          //开机自动启动dns服务\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"第二章-扩展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二章-扩展"}},[s._v("#")]),s._v(" 第二章 扩展")]),s._v(" "),a("h3",{attrs:{id:"_2-1-查看是否已经安装dns包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-查看是否已经安装dns包"}},[s._v("#")]),s._v(" 2.1 查看是否已经安装DNS包")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-qa")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("bind-9.7.0-5.P2.el6.i686.rpm        //默认没有安装")]),s._v(" "),a("p",[s._v("bind-libs-9.7.0-5.P2.el6.i686       //默认已安装bind-libs包")]),s._v(" "),a("p",[s._v("bind-utils-9.7.0-5.P2.el6.i686      //默认已安装bind-utils包，有nslookup命令")]),s._v(" "),a("p",[s._v("bind-chroot-9.7.0-5.P2.el6.i686.rpm //默认没有安装")]),s._v(" "),a("h3",{attrs:{id:"_2-2-安装-基于本地安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-安装-基于本地安装"}},[s._v("#")]),s._v(" 2.2 安装(基于本地安装)")]),s._v(" "),a("h4",{attrs:{id:"_2-2-1-挂载光驱"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-挂载光驱"}},[s._v("#")]),s._v(" 2.2.1 挂载光驱")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" /dev/cdrom /media\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /media/Packages\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" bind*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"_2-2-2-安装dns包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-安装dns包"}},[s._v("#")]),s._v(" 2.2.2 安装DNS包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ivh")]),s._v(" bind-9.7.0-5.P2.el6.i686.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ivh")]),s._v(" bind-chroot-9.7.0-5.P2.el6.i686.rpm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_2-2-3-启动服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-启动服务"}},[s._v("#")]),s._v(" 2.2.3 启动服务")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" named start\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-2-4-关闭防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-关闭防火墙"}},[s._v("#")]),s._v(" 2.2.4 关闭防火墙")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables stop          //临时关闭防火墙\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" iptables off         //设置开机关闭防火墙\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--list")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" iptables  //检查开机状态\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#iptables       \t0:关闭\t1:关闭\t2:关闭\t3:关闭\t4:关闭\t5:关闭\t6:关闭")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"_2-2-5-关闭selinux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-5-关闭selinux"}},[s._v("#")]),s._v(" 2.2.5 关闭SELinux")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("setenforce "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置SELinux为Permissive")]),s._v("\ngetenforce                     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看状态")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Permissive                       #宽容模式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/selinux/config        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置开机SELinux为Permissive")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#更改配置为如下参数\nSELINUX=Permissive\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_2-2-6-开机自动启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-6-开机自动启动"}},[s._v("#")]),s._v(" 2.2.6 开机自动启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" named on             //设置开机自动启动\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--list")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" named  //查看运行状态\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#named      \t0:关闭\t1:关闭\t2:启用\t3:启用\t4:启用\t5:启用\t6:关闭")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"_2-2-7-dns默认功能测试及众多配置文件的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-dns默认功能测试及众多配置文件的作用"}},[s._v("#")]),s._v(" 2.2.7 DNS默认功能测试及众多配置文件的作用")]),s._v(" "),a("h5",{attrs:{id:"_2-2-7-1-默认可以对主机名localhost进行正向解析和反向解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-1-默认可以对主机名localhost进行正向解析和反向解析"}},[s._v("#")]),s._v(" 2.2.7.1 默认可以对主机名localhost进行正向解析和反向解析")]),s._v(" "),a("p",[s._v("在测试默认的功能之前，必须先将Linux系统中的DNS设置为本机的IP：192.168.112.128，即将本机作为Linux系统上网的DNS服务器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim /etc/resolv.conf\nnameserver 192.168.112.128\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("修改配置文件/etc/named.conf中关于DNS的安全访问控制")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim /etc/named.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('options {\n  listen-on port 53 { 192.168.112.128; };    #127.0.0.1改为192.168.112.128\n  listen-on-v6 port 53 { ::1; };\n  directory       "/var/named";\n  dump-file       "/var/named/data/cache_dump.db";\n  statistics-file "/var/named/data/named_stats.txt";\n  memstatistics-file "/var/named/data/named_mem_stats.txt";\n  allow-query     { any; };    //localhost改为any\n  recursion yes;\n  #dnssec-enable yes;                         //注释掉\n  #dnssec-validation yes;                     //注释掉\n  #dnssec-lookaside auto;                     //注释掉\n  /* Path to ISC DLV key */\n  bindkeys-file "/etc/named.iscdlv.key";\n};\nlogging {\n  channel default_debug {\n  file "data/named.run";\n  severity dynamic;\n  };\n};\nzone "." IN {\n  type hint;\n  file "named.ca";\n};                 #第35-38行不能删，因为它能解析整个互联网\ninclude "/etc/named.rfc1912.zones";                //主配置文件/etc/named.rfc1912.zones，用于增加主机名和域名的正向解析和反向解析配置\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("p",[s._v("①第11行127.0.0.1改为192.168.112.128")]),s._v(" "),a("p",[s._v("②第17行localhost改为any")]),s._v(" "),a("p",[s._v("③第20-22行注释掉：//注释掉3行")]),s._v(" "),a("p",[s._v("重新启动DNS服务器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" named restart\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/resolv.conf\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#nameserver 192.168.112.128")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h5",{attrs:{id:"_2-2-7-2-默认可以对主机名localhost进行正向解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-2-默认可以对主机名localhost进行正向解析"}},[s._v("#")]),s._v(" 2.2.7.2 默认可以对主机名localhost进行正向解析")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" localhost  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#正向解析")]),s._v("\nlocalhost has address "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\nlocalhost has IPv6 address ::1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#正向解析成功！")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("E：去掉localhost has IPv6 address ::1提示的方法")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /var/named/named.localhost\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$TTL 1D\n@       IN SOA  @ rname.invalid. (\n                                         0       ; serial\n                                         1D      ; refresh\n                                         1H      ; retry\n                                         1W      ; expire\n                                        3H )    ; minimum\n         NS      @\n         A       127.0.0.1\n         AAAA    ::1                //删掉第10行\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("验证：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service named restart\nhost localhost\nlocalhost has address 127.0.0.1\n正向解析成功！\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h5",{attrs:{id:"_2-2-7-3-默认可以对主机名localhost进行反向解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-3-默认可以对主机名localhost进行反向解析"}},[s._v("#")]),s._v(" 2.2.7.3 默认可以对主机名localhost进行反向解析")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /var/named/named.loopback\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$TTL 1D\n@       IN SOA  @ rname.invalid. (\n                                         0       ; serial\n                                         1D      ; refresh\n                                         1H      ; retry\n                                         1W      ; expire\n                                         3H )    ; minimum\n         NS      @\n         A       127.0.0.1\n         AAAA    ::1                //删掉第10行\n         PTR     localhost.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("host 127.0.0.1  //反向解析\n1.0.0.127.in-addr.arpa domain name pointer localhost.\n反向解析成功！\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h5",{attrs:{id:"_2-2-7-4-默认可以解析整个互联网"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-4-默认可以解析整个互联网"}},[s._v("#")]),s._v(" 2.2.7.4 默认可以解析整个互联网")]),s._v(" "),a("p",[s._v("做此测试操作的前提是，Linux本身能够正常上网（即能够正常打开网页）。")]),s._v(" "),a("p",[s._v("只是将原来的DNS设置成我们自己的DNS服务器，以此来测试我们自己的DNS服务器的功能。")]),s._v(" "),a("p",[s._v("先用Linux中的命令host来进行测试，如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("host www.baidu.com\nhost www.sohu.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("再将Windows作为客户端，在图形界面下测试DNS是否能够解析整个互联网（即是否能够通过自己的DNS服务器来打开网页）。")]),s._v(" "),a("p",[s._v("前提条件是要保证Windows与Linux能够Ping通。（在虚拟机里准备或安装一个Win7 NAT方式来进行测试）")]),s._v(" "),a("h5",{attrs:{id:"_2-2-7-5-dns服务器各个配置文件的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-dns服务器各个配置文件的作用"}},[s._v("#")]),s._v(" 2.2.7.5 DNS服务器各个配置文件的作用")]),s._v(" "),a("p",[s._v("以主机名wgxy和域名test.com为例")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-1-etc-resolv-conf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-1-etc-resolv-conf"}},[s._v("#")]),s._v(" 2.2.7.5.1/etc/resolv.conf")]),s._v(" "),a("p",[s._v("设置域名服务器：修改nameserver 192.168.112.128")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-2-etc-named-conf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-2-etc-named-conf"}},[s._v("#")]),s._v(" 2.2.7.5.2 /etc/named.conf")]),s._v(" "),a("p",[s._v("主配置文件，安全访问控制：修改192.168.112.128，any，//注释掉3行")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-3-etc-named-rfc1912-zones"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-3-etc-named-rfc1912-zones"}},[s._v("#")]),s._v(" 2.2.7.5.3 /etc/named.rfc1912.zones")]),s._v(" "),a("p",[s._v("主配置文件，需要增加主机名wgxy和域名test.com的正向解析和反向解析配置")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-4-var-named-named-ca"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-4-var-named-named-ca"}},[s._v("#")]),s._v(" 2.2.7.5.4 /var/named/named.ca")]),s._v(" "),a("p",[s._v("根域配置文件，不能删，不用修改，因为它能解析整个互联网！")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("; <<>> DiG 9.5.0b2 <<>> +bufsize=1200 +norec NS . @a.root-servers.net\n\n;; global options:  printcmd\n\n;; Got answer:\n\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 34420\n\n;; flags: qr aa; QUERY: 1, ANSWER: 13, AUTHORITY: 0, ADDITIONAL: 20\n ;; OPT PSEUDOSECTION:\n ; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n ;.                              IN      NS\n;; ANSWER SECTION:\n .                       518400  IN      NS      M.ROOT-SERVERS.NET.\n.                       518400  IN      NS      A.ROOT-SERVERS.NET.\n .                       518400  IN      NS      B.ROOT-SERVERS.NET.\n .                       518400  IN      NS      C.ROOT-SERVERS.NET.\n .                       518400  IN      NS      D.ROOT-SERVERS.NET.\n .                       518400  IN      NS      E.ROOT-SERVERS.NET.\n.                       518400  IN      NS      F.ROOT-SERVERS.NET.\n .                       518400  IN      NS      G.ROOT-SERVERS.NET.\n .                       518400  IN      NS      H.ROOT-SERVERS.NET.\n .                       518400  IN      NS      I.ROOT-SERVERS.NET.\n .                       518400  IN      NS      J.ROOT-SERVERS.NET.\n .                       518400  IN      NS      K.ROOT-SERVERS.NET.\n .                       518400  IN      NS      L.ROOT-SERVERS.NET.\n;; ADDITIONAL SECTION:\n A.ROOT-SERVERS.NET.     3600000 IN      A       198.41.0.4\n A.ROOT-SERVERS.NET.     3600000 IN      AAAA    2001:503:ba3e::2:30\n B.ROOT-SERVERS.NET.     3600000 IN      A       192.228.79.201\n C.ROOT-SERVERS.NET.     3600000 IN      A       192.33.4.12\n D.ROOT-SERVERS.NET.     3600000 IN      A       128.8.10.90\n E.ROOT-SERVERS.NET.     3600000 IN      A       192.203.230.10\n F.ROOT-SERVERS.NET.     3600000 IN      A       192.5.5.241\n F.ROOT-SERVERS.NET.     3600000 IN      AAAA    2001:500:2f::f\n G.ROOT-SERVERS.NET.     3600000 IN      A       192.112.36.4\nH.ROOT-SERVERS.NET.     3600000 IN      A       128.63.2.53\n H.ROOT-SERVERS.NET.     3600000 IN      AAAA    2001:500:1::803f:235\n I.ROOT-SERVERS.NET.     3600000 IN      A       192.36.148.17\n J.ROOT-SERVERS.NET.     3600000 IN      A       192.58.128.30\n J.ROOT-SERVERS.NET.     3600000 IN      AAAA    2001:503:c27::2:30\n K.ROOT-SERVERS.NET.     3600000 IN      A       193.0.14.129\n K.ROOT-SERVERS.NET.     3600000 IN      AAAA    2001:7fd::1\n L.ROOT-SERVERS.NET.     3600000 IN      A       199.7.83.42\n M.ROOT-SERVERS.NET.     3600000 IN      A       202.12.27.33\n M.ROOT-SERVERS.NET.     3600000 IN      AAAA    2001:dc3::35\n;; Query time: 147 msec\n;; SERVER: 198.41.0.4#53(198.41.0.4)\n;; WHEN: Mon Feb 18 13:29:18 2008\n ;; MSG SIZE  rcvd: 615\n")])])]),a("p",[s._v("A-M，13台根域名服务器")]),s._v(" "),a("p",[s._v("根服务器，主要用来管理互联网的主目录，全世界IPv4根服务器只有13台（这13台IPv4根域名服务器名字分别为“A”至“M”），1个为主根服务器在美国。其余12个均为辅根服务器，其中9个在美国，欧洲2个（英国和瑞典），亚洲1个（日本）。")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-5-var-named-named-localhost"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-5-var-named-named-localhost"}},[s._v("#")]),s._v(" 2.2.7.5.5 /var/named/named.localhost")]),s._v(" "),a("p",[s._v("本机默认主机名localhost的正向解析文件：localhost→127.0.0.1")]),s._v(" "),a("p",[s._v("named.localhost和named.loopback文件起着“模板文件”的作用。")]),s._v(" "),a("p",[s._v("在实际配置DNS的过程中，一般都是将这两个文件改名复制成自定义域名的正向解析文件和反向解析文件，然后再在其基础上进行相应的修改。")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-6-var-named-named-loopback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-6-var-named-named-loopback"}},[s._v("#")]),s._v(" 2.2.7.5.6 /var/named/named.loopback")]),s._v(" "),a("p",[s._v("本机默认主机名localhost的反向解析文件：127.0.0.1→localhost")]),s._v(" "),a("p",[s._v("named.localhost和named.loopback文件起着“模板文件”的作用。")]),s._v(" "),a("p",[s._v("在实际配置DNS的过程中，一般都是将这两个文件改名复制成自定义域名的正向解析文件和反向解析文件，然后再在其基础上进行相应的修改。")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-7-var-named-wgxy-zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-7-var-named-wgxy-zone"}},[s._v("#")]),s._v(" 2.2.7.5.7 /var/named/wgxy.zone")]),s._v(" "),a("p",[s._v("主机名wgxy的正向解析文件")]),s._v(" "),a("p",[s._v("wgxy→192.168.112.128")]),s._v(" "),a("p",[s._v("来自named.localhost模板，将第9行A  127.0.0.1改为A  192.168.112.128")]),s._v(" "),a("h6",{attrs:{id:"_2-2-7-5-8-var-named-test-com-zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-8-var-named-test-com-zone"}},[s._v("#")]),s._v(" 2.2.7.5.8 /var/named/test.com.zone")]),s._v(" "),a("p",[s._v("某域名test.com的正向解析文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dns.test.com→192.168.112.128  //DNS服务器\nwww.test.com→192.168.112.128  //Web服务器\nftp.test.com→192.168.112.128  //FTP服务器\nmail.test.com→192.168.112.129  //Mail服务器\n#在/etc/named.rfc1912.zones中定义\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h6",{attrs:{id:"_2-2-7-5-9-var-named-192-168-112-arpa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-7-5-9-var-named-192-168-112-arpa"}},[s._v("#")]),s._v(" 2.2.7.5.9 /var/named/192.168.112.arpa")]),s._v(" "),a("p",[s._v("某域名test.com的反向解析文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("192.168.112.128→dns.test.com\n192.168.112.128→www.test.com\n192.168.112.128→ftp.test.com\n192.168.112.129→mail.test.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("在/etc/named.rfc1912.zones中定义")]),s._v(" "),a("h5",{attrs:{id:"_2-2-8-配置本机主机名wgxy的正向解析及测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-8-配置本机主机名wgxy的正向解析及测试"}},[s._v("#")]),s._v(" 2.2.8 配置本机主机名wgxy的正向解析及测试")]),s._v(" "),a("p",[s._v("正向解析：wgxy→192.168.112.128")]),s._v(" "),a("p",[s._v("(1)首先，在/etc/named.rfc1912.zones文件中定义该主机名的一个正向域")]),s._v(" "),a("p",[s._v("vim /etc/named.rfc1912.zones")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('zone "localhost" IN {\n         type master;\n         file "named.localhost";\n         allow-update { none; };\n }; \n')])])]),a("p",[s._v("复制以上19-24行共6行，并改为：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('zone "wgxy" IN {           //定义该主机名的一个域zone\n         type master;\n         file "wgxy.zone";  //指定该主机名的正向解析文件。记住该文件名，一会儿要在/var/named目录中去创建它\n         allow-update { none; };\n }; \n')])])]),a("p",[s._v("(2)然后，进入/var/named目录，复制named.localhost并改名为wgxy.zone")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /var/named\ncp -p named.localhost wgxy.zone\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("vim wgxy.zone")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$TTL 1D\n@       IN SOA  @ rname.invalid. (\n                                         0       ; serial   //版本号\n                                         1D      ; refresh  //每隔1天刷新纪录\n                                         1H      ; retry    //每隔1小时重发请求\n                                         1W      ; expire   //1周无法连接上主域名服务器，DNS记录失效\n                                         3H )    ; minimum  //DNS记录TTL的最小值为3小时\n         NS      @\n         A       192.168.112.128                            //将该行的IP“127.0.0.1”，改为“192.168.112.128”即可！\n")])])]),a("p",[s._v("(3)重启DNS服务器，并进行主机名“wgxy”的正向解析测试")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service named restart\nhost wgxy\nwgxy has address 192.168.112.128\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("能正向解析出主机名“wgxy”对应的IP地址，配置成功！")]),s._v(" "),a("p",[s._v("注：若显示：Host wgxy not found: 3(NXDOMAIN)，再次修改# vim /etc/resolv.conf中的nameserver 192.168.112.128")]),s._v(" "),a("h5",{attrs:{id:"_2-2-9-配置本机主机名wgxy的反向解析及测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-9-配置本机主机名wgxy的反向解析及测试"}},[s._v("#")]),s._v(" 2.2.9 配置本机主机名wgxy的反向解析及测试")]),s._v(" "),a("p",[s._v("反向解析：192.168.112.128→wgxy")]),s._v(" "),a("p",[s._v("(1)首先，在/etc/named.rfc1912.zones文件中定义该主机名的一个反向域：")]),s._v(" "),a("p",[s._v("vim /etc/named.rfc1912.zones")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('zone "1.0.0.127.in-addr.arpa" IN {\n        type master;\n        file "named.loopback";\n        allow-update { none; };\n}; \n')])])]),a("p",[s._v("复制以上37-42行共6行，并改为：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('zone "112.168.192.in-addr.arpa" IN {   //注意：反向解析的最大的一个特点就是将IP地址“192.168.112.128”反着写\n        type master;\n         file "192.168.112.arpa";       //指定该主机名的反向解析文件。记住该文件名，一会儿要在/var/named目录中去创建它\n         allow-update { none; };\n};\n')])])]),a("p",[s._v("(2)然后，进入/var/named目录，复制named.loopback并改名为192.168.112.arpa")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /var/named\ncp -p named.loopback 192.168.112.arpa\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("vim 192.168.112.arpa")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$TTL 1D\n@       IN SOA  @ rname.invalid. (\n                                        0       ; serial\n                                         1D      ; refresh\n                                        1H      ; retry\n                                        1W      ; expire\n                                        3H )    ; minimum\n        NS      @\n         A       192.168.112.128 //将该行的IP“127.0.0.1”，改为“192.168.112.128”\n         AAAA    ::1             //删除该行IPv6的地址\n 128     PTR     wgxy.           //128，即192.168.112.128；PTR即指向后面的“wgxy.”，注意后面的那个点“.”不能掉，否则配置不成功！\n")])])]),a("p",[s._v("(3)重启DNS服务器，并进行主机名“wgxy”的反向解析测试")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service named restart\nhost 192.168.112.128\n128.112.168.192.in-addr.arpa domain name pointer wgxy.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("能反向解析出IP地址“192.168.112.128”对应的主机名，配置成功！")]),s._v(" "),a("h5",{attrs:{id:"_2-2-10-配置域名-test-com-的正向解析及测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-10-配置域名-test-com-的正向解析及测试"}},[s._v("#")]),s._v(" 2.2.10 配置域名“test.com”的正向解析及测试")]),s._v(" "),a("p",[s._v("(1)首先，在/etc/named.rfc1912.zones文件中定义“test.com”的正向域")]),s._v(" "),a("p",[s._v("vim /etc/named.rfc1912.zones")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('zone "wgxy" IN {\n        type master;\n        file "wgxy.zone";\n        allow-update { none; };\n};\n')])])]),a("p",[s._v("复制以上25-30行共6行，并改为：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('zone "test.com" IN {          //定义“test.com”这个域\n         type master;\n        file "test.com.zone"; //指定该主机名的正向解析文件。记住该文件名，一会儿要在/var/named目录中去创建它\n         allow-update { none; };\n};\n')])])]),a("p",[s._v("(2)然后，进入/var/named目录，复制named.localhost并改名为test.com.zone")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("cd /var/named\ncp -p named.localhost test.com.zone\nvim test.com.zone\n")])])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$TTL 1D\n@       IN SOA  @ rname.invalid. (\n                                         0       ; serial\n                                        1D      ; refresh\n                                        1H      ; retry\n                                         1W      ; expire\n                                        3H )    ; minimum\n         NS      dns.test.com.      //“test.com”这个域的DNS服务器，必须有。注意这个点“.”\n        MX 5    mail.test.com.     //该域的邮件服务器。注意这个点“.”\ndns    A    192.168.112.128    //DNS服务器对应的IP地址\nwww    A    192.168.112.128    //网页服务器对应的IP地址\nftp    CNAME    www                //FTP服务器是www的别名，即与www服务器使用相同的IP地址\nmail    A    192.168.112.129    //邮件服务器对应的IP地址\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("(3)重启DNS服务器，并对各种服务器进行正向解析测试")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service named restart\nvim /etc/resolv.conf\nhost dns.test.com\ndns.test.com has address 192.168.112.128\nhost www.test.com\nwww.test.com has address 192.168.112.128\nhost ftp.test.com\nftp.test.com is an alias for www.test.com.\nwww.test.com has address 192.168.112.128\nhost mail.test.com\nmail.test.com has address 192.168.112.129\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("能正向解析出各个域名所对应的IP地址，配置成功！")]),s._v(" "),a("p",[s._v("(4)架设一个Web服务器，并用vi编辑器制作一个简单的网页（已经Xftp上传网站到/var/www/html/TestWeb2/），")]),s._v(" "),a("p",[s._v("然后在虚拟机Win7（IP：192.168.112.129）里通过域名www.test.com访问该网页。")]),s._v(" "),a("p",[s._v("1)在Linux里安装Web服务器，并启动它(自动安装，前述已设置开机自动启动)；")]),s._v(" "),a("p",[s._v("2)在其网页目录中(/etc/www/html/TestWeb2)制作一个简单网页index.html（已经xftp上传网站到/var/www/html/TestWeb2/）；")]),s._v(" "),a("p",[s._v("3)更改Windows里的DNS设置，使其指向Linux中的DNS服务器192.168.112.128；")]),s._v(" "),a("p",[s._v("4)打开Windows中的浏览器，输入域名http://www.test.com/TestWeb2/进行浏览测试。")]),s._v(" "),a("p",[s._v("访问外网也应该能成功？nameserver 8.8.8.8？")]),s._v(" "),a("p",[s._v("Web服务器、DNS服务器合并操作，配置成功！")]),s._v(" "),a("h5",{attrs:{id:"_2-2-11-配置域名-test-com-的反向解析及测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-11-配置域名-test-com-的反向解析及测试"}},[s._v("#")]),s._v(" 2.2.11 配置域名“test.com”的反向解析及测试")]),s._v(" "),a("p",[s._v("192.168.112.128  dns.test.com")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("             www.test.com\n\n             ftp.test.com\n")])])]),a("p",[s._v("192.168.112.129  mail.test.com")]),s._v(" "),a("p",[s._v("由于在前面配置本机主机名的反向解析时，")]),s._v(" "),a("p",[s._v("在/etc/named.rfc1912.zones文件建立过“192.168.112.0/24”这个IP段的反向域及其反向解析文件，")]),s._v(" "),a("p",[s._v("故在此删除或改用该IP段的反向域及其反向解析文件。")]),s._v(" "),a("p",[s._v("(1)首先，在/etc/named.rfc1912.zones文件中定义“test.com”的反向域")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim /etc/named.rfc1912.zones\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("(2)然后，进入/var/named目录，复制named.loopback并改名为192.168.112.arpa（前面主机名的反向解析已复制、改名）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /var/named/192.168.112.arpa\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$TTL 1D\n@\tIN SOA\t@ rname.invalid. (\n\t\t\t\t\t\t0\t; serial\n\t\t\t\t\t\t1D\t; refresh\n\t\t\t\t\t\t1H\t; retry\n\t\t\t\t\t1W\t; expire\n\t\t\t\t\t3H )\t; minimum\n\t\t  NS    dns.test.com.\n128    PTR    dns.test.com.\n128    PTR    www.test.com.\n128    PTR    ftp.test.com.\n129    PTR    mail.test.com.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("各个服务器对应IP的最后一个数字，如128，通过PTR指向其对应的域名。")]),s._v(" "),a("p",[s._v("注意：后面的那个点不能掉，否则配置不成功！")]),s._v(" "),a("p",[s._v("(3)重启DNS服务器，并对以下各个域名进行反向解析测试")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service named restart\n\nvim /etc/resolv.conf\n\nhost 192.168.112.128\n\n128.112.168.192.in-addr.arpa domain name pointer dns.test.com.\n\n128.112.168.192.in-addr.arpa domain name pointer ftp.test.com.\n\n128.112.168.192.in-addr.arpa domain name pointer www.test.com.\n\nhost 192.168.112.129\n\n129.112.168.192.in-addr.arpa domain name pointer mail.test.com.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("反向解析成功！")]),s._v(" "),a("h2",{attrs:{id:"第三章-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三章-总结"}},[s._v("#")]),s._v(" 第三章 总结")]),s._v(" "),a("p",[s._v("DNS服务器9个配置文件及作用：")]),s._v(" "),a("p",[s._v("以配置"),a("wgxy",[s._v(".test.com的dns、www、ftp、mail为例：")])],1),s._v(" "),a("p",[s._v("主机名wgxy，IP地址192.168.112.128，域名test.com，服务dns、www、ftp、mail")]),s._v(" "),a("p",[s._v("目录：/etc/，3个文件")]),s._v(" "),a("p",[s._v("-rw-r--r--. 1 root root   123  3月 11 12:20 resolv.conf")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root named  936  3月 11 12:27 named.conf")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root named 1203  3月 11 12:44 named.rfc1912.zones")]),s._v(" "),a("p",[s._v("目录：/var/named/，6个文件")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root  named 1892  2月 18 2008  named.ca")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root  named  142  3月 11 12:28 named.localhost")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root  named  158  3月 11 12:29 named.loopback")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root  named  148  3月 11 12:35 wgxy.zone")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root  named  244  3月 11 12:53 test.com.zone")]),s._v(" "),a("p",[s._v("-rw-r-----. 1 root  named  230  3月 11 12:58 192.168.112.arpa")]),s._v(" "),a("p",[s._v("9个文件分布在两个目录")]),s._v(" "),a("p",[s._v("resolv.conf         //设置域名服务器：修改nameserver 192.168.112.128")]),s._v(" "),a("p",[s._v("named.conf          //主配置文件，安全访问控制：修改192.168.112.128，any，//注释掉3行")]),s._v(" "),a("p",[s._v("●named.rfc1912.zones //主配置文件，增加主机名wgxy和域名test.com的正向解析和反向解析配置")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('            正向解析                                |反向解析\n\nzone "wgxy" IN {\t\t\t|\n    type master;\t\t\t|\n\n    file "wgxy.zone";\t        |\n\n        allow-update { none; };\t|\n\n };//主机名wgxy的正向解析，见③\t|\n\n                                                |\n\nzone "test.com" IN {\t\t\t|49 zone "112.168.192.in-addr.arpa" IN {\n\n        type master;\t\t\t|50         type master;\n\n         file "test.com.zone";\t|51         file "192.168.112.arpa";\t\n\n         allow-update { none; };\t|52         allow-update { none; };\n\n};//域名test.com的正向解析，见④\t|53 };//域名test.com的反向解析，见⑤\n')])])]),a("p",[s._v("named.ca            //根域配置文件，不能删，不用修改，因为它能解析整个互联网！")]),s._v(" "),a("p",[s._v("①named.localhost     //默认主机名localhost的正向解析文件：删掉第10行(不要IPv6地址)：AAAA  ::1")]),s._v(" "),a("p",[s._v("②named.loopback      //默认主机名localhost的反向解析文件：删掉第10行(不要IPv6地址)：AAAA  ::1")]),s._v(" "),a("p",[s._v("③wgxy.zone           //主机名wgxy的正向解析文件：来自named.localhost模板，将第9行A  127.0.0.1改为A  192.168.112.128")]),s._v(" "),a("p",[s._v("④test.com.zone       //域名test.com的正向解析文件：来自named.localhost模板，将")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("NS\t@\nA\t127.0.0.1\n")])])]),a("p",[s._v("改为：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("\t\tNS    dns.test.com.\n\n\t\tMX 5    mail.test.com.\n\n dns    A    192.168.112.128\n\n www    A\t    192.168.112.128\n\n ftp    CNAME    www\n\n mail    A    192.168.112.129\n")])])]),a("p",[s._v("⑤192.168.112.arpa    //域名test.com的反向解析文件：来自named.loopback模板，将")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("\t\tNS\t@\n\n\t\tA\t127.0.0.1\n\n\tPTR\tlocalhost.\n")])])]),a("p",[s._v("改为：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("\t\tNS\tdns.test.com.\n\t128\tPTR\tdns.test.com.\n 128\tPTR\twww.test.com.\n 128\tPTR\tftp.test.com.\n 129\tPTR\tmail.test.com.\n")])])])])}),[],!1,null,null,null);a.default=t.exports}}]);