(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{578:function(s,a,t){"use strict";t.r(a);var e=t(2),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"第一章-整体目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一章-整体目录"}},[s._v("#")]),s._v(" 第一章 整体目录")]),s._v(" "),a("ol",[a("li",[s._v("备份服务")]),s._v(" "),a("li",[s._v("储存服务")]),s._v(" "),a("li",[s._v("实时同步服务")]),s._v(" "),a("li",[s._v("批量管理服务")]),s._v(" "),a("li",[s._v("网站服务（web服务）")]),s._v(" "),a("li",[s._v("LNMP网站架构")]),s._v(" "),a("li",[s._v("负载均衡反向代理服务")]),s._v(" "),a("li",[s._v("高可用服务")]),s._v(" "),a("li",[s._v("监控服务")]),s._v(" "),a("li",[s._v("跳板机服务")]),s._v(" "),a("li",[s._v("防火墙服务")])]),s._v(" "),a("h2",{attrs:{id:"第二章-中小规模网站架构组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二章-中小规模网站架构组成"}},[s._v("#")]),s._v(" 第二章 中小规模网站架构组成")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("顾客--用户")]),s._v(" "),a("p",[s._v("访问网站的人员")])]),s._v(" "),a("li",[a("p",[s._v("保安--防火墙（firewalld）")]),s._v(" "),a("p",[s._v("进行访问策略控制")])]),s._v(" "),a("li",[a("p",[s._v("迎宾--负载均衡服务器（nginx）")]),s._v(" "),a("p",[s._v("对用户的访问请求进行调度处理")])]),s._v(" "),a("li",[a("p",[s._v("服务员--web服务器（nginx）")]),s._v(" "),a("p",[s._v("处理用户的请求")])]),s._v(" "),a("li",[a("p",[s._v("厨师--数据库服务器（mysql）")]),s._v(" "),a("p",[s._v("存储字符数据（耳机 500 索尼 黑色 北京地址 订单时间2022-08-04 17:22:20）")])]),s._v(" "),a("li",[a("p",[s._v("厨师--存储服务器（nfs）")]),s._v(" "),a("p",[s._v("存储图片 音频 视频 附件等数据信息")])]),s._v(" "),a("li",[a("p",[s._v("厨师--备份服务器（rsync+crond-定时服务 rsync+sersync-实时备份）")]),s._v(" "),a("p",[s._v("存储网站所有服务器的重要数据")])]),s._v(" "),a("li",[a("p",[s._v("厨师--缓存服务器（memcache redis mongodb）")]),s._v(" "),a("ul",[a("li",[s._v("将数据信息存储到内存中")]),s._v(" "),a("li",[s._v("减缓服务器的压力")])])]),s._v(" "),a("li",[a("p",[s._v("经理--批量管理服务器（ansible）")]),s._v(" "),a("p",[s._v("批量管理多台服务器主机")])])]),s._v(" "),a("h2",{attrs:{id:"第三章-部署网站架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三章-部署网站架构"}},[s._v("#")]),s._v(" 第三章 部署网站架构")]),s._v(" "),a("h3",{attrs:{id:"_3-1-需要解决网站架构单点问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-需要解决网站架构单点问题"}},[s._v("#")]),s._v(" 3.1 需要解决网站架构单点问题")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("迎宾")]),s._v(" "),a("p",[s._v("高可用服务------keepalived")])]),s._v(" "),a("li",[a("p",[s._v("数据库")]),s._v(" "),a("p",[s._v("高可用服务------mha")])]),s._v(" "),a("li",[a("p",[s._v("储存服务")]),s._v(" "),a("p",[s._v("高可用服务------keepalived实现")]),s._v(" "),a("p",[s._v("高可用服务------分布式储存")])]),s._v(" "),a("li",[a("p",[s._v("备份服务")]),s._v(" "),a("p",[s._v("公司数据如何备份：")]),s._v(" "),a("ol",[a("li",[s._v("利用开源软件实现数据备份           rsync（免费）")]),s._v(" "),a("li",[s._v("利用企业网盘进行数据备份           七牛云储存")]),s._v(" "),a("li",[s._v("利用自建备份存储架构          两地三中心")])])]),s._v(" "),a("li",[a("p",[s._v("缓存服务")]),s._v(" "),a("p",[s._v("高可用服务 ----- 缓存服务器集群 / 哨兵模式")])])]),s._v(" "),a("h3",{attrs:{id:"_3-2-内部员工如何远程访问架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-内部员工如何远程访问架构"}},[s._v("#")]),s._v(" 3.2 内部员工如何远程访问架构")]),s._v(" "),a("p",[s._v("部署搭建VPN服务器 PPTP VPN")]),s._v(" "),a("h3",{attrs:{id:"_3-3-内部员工操作管理架构服务器要进行审计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-内部员工操作管理架构服务器要进行审计"}},[s._v("#")]),s._v(" 3.3 内部员工操作管理架构服务器要进行审计")]),s._v(" "),a("p",[s._v("跳板机服务器 jumpserver")]),s._v(" "),a("h3",{attrs:{id:"_3-4-架构中服务器出现问题需要进行提前报警告知"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-架构中服务器出现问题需要进行提前报警告知"}},[s._v("#")]),s._v(" 3.4 架构中服务器出现问题需要进行提前报警告知")]),s._v(" "),a("p",[s._v("部署监控服务器  zabbix")]),s._v(" "),a("h2",{attrs:{id:"第四章-综合架构规划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第四章-综合架构规划"}},[s._v("#")]),s._v(" 第四章 综合架构规划")]),s._v(" "),a("p",[s._v("主机名称和IP地址规划")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("功能")]),s._v(" "),a("th",[s._v("名称")]),s._v(" "),a("th",[s._v("外网地址")]),s._v(" "),a("th",[s._v("内网地址")]),s._v(" "),a("th",[s._v("软件")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("防火墙服务")]),s._v(" "),a("td",[s._v("firewalld")]),s._v(" "),a("td",[s._v("10.0.0.81")]),s._v(" "),a("td",[s._v("172.16.1.81")]),s._v(" "),a("td",[s._v("firewalld")])]),s._v(" "),a("tr",[a("td",[s._v("防火墙服务")]),s._v(" "),a("td",[s._v("lb01")]),s._v(" "),a("td",[s._v("10.0.0.5")]),s._v(" "),a("td",[s._v("172.16.1.5")]),s._v(" "),a("td",[s._v("nginx keepalived")])]),s._v(" "),a("tr",[a("td",[s._v("防火墙服务")]),s._v(" "),a("td",[s._v("lb02")]),s._v(" "),a("td",[s._v("10.0.0.6")]),s._v(" "),a("td",[s._v("172.16.1.6")]),s._v(" "),a("td",[s._v("nginx  keepalived")])]),s._v(" "),a("tr",[a("td",[s._v("web服务器")]),s._v(" "),a("td",[s._v("web01")]),s._v(" "),a("td",[s._v("10.0.0.7")]),s._v(" "),a("td",[s._v("172.16.1.7")]),s._v(" "),a("td",[s._v("nginx")])]),s._v(" "),a("tr",[a("td",[s._v("web服务器")]),s._v(" "),a("td",[s._v("web02")]),s._v(" "),a("td",[s._v("10.0.0.8")]),s._v(" "),a("td",[s._v("172.16.1.8")]),s._v(" "),a("td",[s._v("nginx")])]),s._v(" "),a("tr",[a("td",[s._v("web服务器")]),s._v(" "),a("td",[s._v("web03")]),s._v(" "),a("td",[s._v("10.0.0.9")]),s._v(" "),a("td",[s._v("172.16.1.9")]),s._v(" "),a("td",[s._v("nginx")])]),s._v(" "),a("tr",[a("td",[s._v("数据库服务器")]),s._v(" "),a("td",[s._v("db01")]),s._v(" "),a("td",[s._v("10.0.0.51")]),s._v(" "),a("td",[s._v("172.16.1.51")]),s._v(" "),a("td",[s._v("mysql(慢)  mariaDB")])]),s._v(" "),a("tr",[a("td",[s._v("储存服务器")]),s._v(" "),a("td",[s._v("nfs01")]),s._v(" "),a("td",[s._v("10.0.0.31")]),s._v(" "),a("td",[s._v("172.16.1.31")]),s._v(" "),a("td",[s._v("nfs")])]),s._v(" "),a("tr",[a("td",[s._v("备份服务器")]),s._v(" "),a("td",[s._v("backup")]),s._v(" "),a("td",[s._v("10.0.0.41")]),s._v(" "),a("td",[s._v("172.16.1.41")]),s._v(" "),a("td",[s._v("rsync")])]),s._v(" "),a("tr",[a("td",[s._v("批量管理服务器")]),s._v(" "),a("td",[s._v("m01")]),s._v(" "),a("td",[s._v("10.0.0.61")]),s._v(" "),a("td",[s._v("172.16.1.61")]),s._v(" "),a("td",[s._v("ansible")])]),s._v(" "),a("tr",[a("td",[s._v("跳板机服务器")]),s._v(" "),a("td",[s._v("jumpserver")]),s._v(" "),a("td",[s._v("10.0.0.71(61)")]),s._v(" "),a("td",[s._v("172.16.1.71")]),s._v(" "),a("td",[s._v("jumpserver")])]),s._v(" "),a("tr",[a("td",[s._v("监控服务器")]),s._v(" "),a("td",[s._v("zabbix")]),s._v(" "),a("td",[s._v("10.0.0.72(61)")]),s._v(" "),a("td",[s._v("172.16.1.72")]),s._v(" "),a("td",[s._v("zabbix")])])])]),s._v(" "),a("h2",{attrs:{id:"第五章-优化配置模板机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第五章-优化配置模板机"}},[s._v("#")]),s._v(" 第五章 优化配置模板机")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("模板机优化配置---hosts文件配置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("cp /etc/hosts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(",.bak"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/hosts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n::1    localhost localhost.localdomain   localhost6 localhost6.localdomain6\n127.0.0.1      localhost  localhost.localdomain   localhost4    localhost4.localdomain4\n172.16.1.5           lb01\n172.16.1.6           lb02\n172.16.1.7           web01\n172.16.1.8           web02\n172.16.1.9           web03\n172.16.1.51         db01\n172.16.1.31         nfs01\n172.16.1.41         backup\n172.16.1.61         m01\n172.16.1.71         jumpserver\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---更改yum源")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.backup\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/yum.repos.d/epel-testing.repo /etc/yum.repos.d/epel-testing.repo.backup\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("blockquote",[a("p",[s._v("ps")]),s._v(" "),a("p",[s._v("yum repolist 列出yum源信息；")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---关闭selinux")]),s._v(" "),a("p",[s._v("请看Linux运维------\x3e"),a("a",{attrs:{href:"https://blog.cndis.cn/2021/09/16/Linux%E8%BF%90%E7%BB%B4/%E5%BC%80%E5%85%B3%E9%98%B2%E7%81%AB%E5%A2%99&%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/",target:"_blank",rel:"noopener noreferrer"}},[s._v("开关防火墙&软件包开机自启"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---关闭iptables（friewalld）")]),s._v(" "),a("p",[s._v("请看Linux运维------\x3e"),a("a",{attrs:{href:"https://blog.cndis.cn/2021/09/16/Linux%E8%BF%90%E7%BB%B4/%E5%BC%80%E5%85%B3%E9%98%B2%E7%81%AB%E5%A2%99&%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/",target:"_blank",rel:"noopener noreferrer"}},[s._v("开关防火墙&软件包开机自启"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("安装的软件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" net-tools policycoreutils-pyt\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---提权ljq用户可以sudo（可选配置）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" ljq\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--stdin")]),s._v(" ljq\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("cp /etc/sudoers /etc/sudoers.ori\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ljq ALL=(ALL) NOPASSWD:ALL"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/sudoers\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v(" /etc/sudoers\nvisudo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---英文字符集")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("localectl set-locale "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"en_US.UTF-8"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---时间同步")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("timedatectl set-timezone Asia/Shanghai  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置时区为上海")]),s._v("\nntpdate ntp1.aliyun.com\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" ntpdate\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#time sync by lidao at 2017-03-08'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/var/spool/cron/root\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*/5 * * * * /usr/sbin/ntpdate pool.ntp.org > /dev/null 2>&1'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/var/spool/cron/root\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---加大文件描述")]),s._v(" "),a("p",[s._v("加大文件描述（加大进程的加载，比如nofile默认是打开1024个文件，当程序运行足够多时，到达1024后再打开程序将无法运行）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*                  -                       nofile                              65535'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/security/limits.conf\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" /etc/security/limits.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("说明")]),s._v(" "),a("p",[s._v("一个服务程序运行起来，会打开相应的文件")]),s._v(" "),a("p",[s._v("crond定时任务服务 --- systemctl start crond --- 打开相应的文件")]),s._v(" "),a("p",[s._v("/var/spool/cron/root          ---加载打开配置文件")]),s._v(" "),a("p",[s._v("/var/log/cron                ---加载打开日志文件")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---安装其它小软件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" lrzsz nmap tree dos2nuix "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" telnet slof ntpdate bash-completion bash-completion-extra\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("模板机优化配置---ssh连接优化")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# vim /etc/ssh/sshd_config\n\t79   GSSAPICleanupCredentials no\n\t112 UseDNS no\n# vi /etc/hosts\n\txxx.xxx.xxx.xxx  [主机名]\n# systemctl restart sshd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"第六章-克隆后的主机配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第六章-克隆后的主机配置"}},[s._v("#")]),s._v(" 第六章 克隆后的主机配置")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("修改主机名")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("hostnamectl set-hostname backup\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("修改主机地址")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grep 200  /etc/sysconfig/network-scripts/ifcfg-eth[01]        查看原文件eth0和eth1中是否有其他重复的数字              \nsed -i 's#200#41#g'  /etc/sysconfig/network-scripts/ifcfg-eth[01]   进行ip的替换\ngrep 41  /etc/sysconfig/network-scripts/ifcfg-eth[01]         查看替换结果\nsed -i '/UUID/d' /etc/sysconfig/network-scripts/ifcfg-eth[01]               删除UUID\ngrep UUID  /etc/sysconfig/network-scripts/ifcfg-eth[01]        查看是否删除UUID\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("ps")]),s._v(" "),a("p",[s._v("一台一台顺序启动，进行修改，不要同时启动")])])])]),s._v(" "),a("h2",{attrs:{id:"第七章-综合架构基本小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第七章-综合架构基本小结"}},[s._v("#")]),s._v(" 第七章 综合架构基本小结")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("网站架构组成")])]),s._v(" "),a("li",[a("p",[s._v("网站架构规划（主机名称 主机地址 系统优化(脚本)）")])]),s._v(" "),a("li",[a("p",[s._v("虚拟主机克隆操作")])]),s._v(" "),a("li",[a("ol",[a("li",[s._v("关闭主机克隆")]),s._v(" "),a("li",[s._v("克隆好的主机一台一台启动按顺序启动，修改配置（主机名称 主机地址）")])])]),s._v(" "),a("li",[a("p",[s._v("rsync备份服务")])]),s._v(" "),a("li",[a("ol",[a("li",[s._v("rsync命令语法 1v4")]),s._v(" "),a("li",[s._v("rsync语法格式 本地备份 远程备份")])])])]),s._v(" "),a("h3",{attrs:{id:"_7-1-综合架构的组成部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-综合架构的组成部分"}},[s._v("#")]),s._v(" 7.1 综合架构的组成部分")]),s._v(" "),a("p",[s._v("前端：防火墙、负载均衡、web服务器")]),s._v(" "),a("p",[s._v("后端：数据库、储存服务、缓存服务、备份服务")]),s._v(" "),a("p",[s._v("扩展：批量管理、跳板机、监控服务、VPN服务")]),s._v(" "),a("h2",{attrs:{id:"第八章-备份服务部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第八章-备份服务部分"}},[s._v("#")]),s._v(" 第八章 备份服务部分")]),s._v(" "),a("p",[s._v("请进入Linux服务>rsync服务")]),s._v(" "),a("h2",{attrs:{id:"第九章-实现发送邮件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第九章-实现发送邮件"}},[s._v("#")]),s._v(" 第九章 实现发送邮件")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("配置163企业邮箱")])]),s._v(" "),a("li",[a("p",[s._v("编写Linux服务邮件相关配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim /etc/mail.rc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("set from=13164646190@163.com smtp=smtp.163.com\nset smtp-auth-user=13164646190@163.com smtp-auth-password=授权密码 smtp-auth=login\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("重启自带的邮件服务")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl restart postfix.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("发送邮件测试")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('echo "邮件发送测试" | mail -s “邮件测试”目标邮箱\n mail -s “邮件测试”目标邮箱 < /etc/hosts   //以hosts文件为文件内容发送\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"第十章-编写全网备份脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第十章-编写全网备份脚本"}},[s._v("#")]),s._v(" 第十章 编写全网备份脚本")]),s._v(" "),a("h3",{attrs:{id:"_10-1-客户端脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-1-客户端脚本"}},[s._v("#")]),s._v(" 10.1 客户端脚本")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir /server/scripts -p     //建立一个专门放脚本的文件\nvim backup.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n\t\t\t\nBackup_dir="/backup"                //定义变量，方便更换\nIP_info=$(hostname -i)\n\t\t\t\n#create backup dir\nmkdir -p $Backup_dir/$IP_info/\n\t\t\t\n#tar backup data\ncd /\ntar zcvf $Backup_dir/$IP_info/date_$(date +%F_week%w -d -1day).tar.gz /etc/hosts\n\t\t\t\n#del 7 day ago date\nfind $Backup_dir -type f -mtime +7 | xargs rm 2>/dev/null\n\t\t\t\n#create finger file\nfind $Backup_dir/ -type f -mtime -1 ! -name "finger*" | xargs md5sum > $Backup_dir/$IP_info/finger.txt\n\t\t\t\n#backup push data info\nrsync -avz $Backup_dir/ rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"_10-2-服务端脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-服务端脚本"}},[s._v("#")]),s._v(" 10.2 服务端脚本")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir /server/scripts -p  \nmkdir -p /backup/10.0.0.31/\nvim backup-server.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n\t\t\t\n#del 180 day ago data\nfind /backup/ -type f -mtime +180 ! -name "*week1.tar.gz" | xargs rm 2>/dev/null\n\t\t\t\n#check backup data\nfind /backup/ -type f -name "finger.txt" | xargs md5sum -c >/tmp/check.txt\n\t\t\t\n#send check mail\nmail -s "check backup info for $(date +%F)" 2044307912@qq.com</tmp/check.txt\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"第十一章-实现自动完成全网数据备份-定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第十一章-实现自动完成全网数据备份-定时任务"}},[s._v("#")]),s._v(" 第十一章 实现自动完成全网数据备份（定时任务）")]),s._v(" "),a("h3",{attrs:{id:"_11-1-客户端定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-客户端定时任务"}},[s._v("#")]),s._v(" 11.1 客户端定时任务")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("crontab -e\n# backup data\n0 0 * * * /bin/sh  /server/scripts/backup.sh &>/dev/null\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_11-2-服务端定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-2-服务端定时任务"}},[s._v("#")]),s._v(" 11.2 服务端定时任务")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("crontab -e\n# backup data\n0 5 * * * /bin/sh  /server/scripts/backup-server.sh &>/dev/null\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);